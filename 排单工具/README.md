本工具用于给公司财务部门提供帮助，可以将汇总的数据表拆分生成明细表，再将明细表和简易财务系统生成的Excel表合并，从而生成完整的对账单。

主要使用的库和版本如下：

```
numpy = 1.25.2
openpyxl = 3.1.2 
pandas = 2.0.3
xlwings = 0.30.10
pyinstaller = 5.13.0
Python = 3.11.4
```

工具采用Python开发，使用numpy、openpyxl、pandas等库读取和处理Excel表格，使用xlwings与Excel交互，并用pyinstaller将Python代码打包成可执行文件，方便在没有Python环境的电脑上运行。

总体来说，本工具旨在提高公司财务对账工作的效率，通过自动化生成对账单明细，节省重复劳动。


# 注意事项

程序应与资料表.xlsx、模板.xlsx存放在同一目录下。

本程序仅支持xlsx格式的文件。

请在资料表.xlsx的价目表1和价目表2中编辑好价目信息，其中价目表1用于存储协议价格，价目表2用于存储固定价格。

检测项目可以进行增删和重命名，但是需要同时修改资料表和模板，并保证资料表的排单明细、模板的使用明细和明细表的检测项目之间保持一致：

1. 资料表中的排单明细的`S1`至`倒数第五列1`可以进行修改，以当前长度为例，为`S1`至`FN1`。

2. 在价目表1或价目表2中可以修改检测项目的名称，其中价目表1可修改的范围是`B1`至`倒数第二列1`，价目表2的可修改范围是第二行至最后一行。

3. 需要确保模板中的明细表的第三行与资料表中的排单明细第一行完全一致。

4. 需要确保模板中的使用明细的`B4`至`B最后一行`的检测项目与明细表的`S1`至`倒数第五列1`的检测项目完全一致。 

模板中可以直接修改样式并同步到生成文件的部分：

1. 使用明细基本都可以修改。
2. 明细表的前三行。

注意事项：请勿在空白行或空白列修改样式，这样会导致程序获取的行数或列数变大。

建议：在模板的使用明细和明细表中，只修改有数据的行和列的样式，避免影响程序的判断。

# 使用说明

首先将数据复制到资料表的排单明细中，从第二行开始粘贴，不要覆盖表头。

将“简易系统对账单”文件夹复制到程序所在目录下。

如果资料表和模板已打开，请关闭。

运行程序，按提示输入账期(格式为yyyymm，例如202309)。

等待程序执行完成，如果提示错误请按提示排除故障。

注意在程序运行期间不要打开生成的文件，否则可能因为文件被占用导致程序无法正常执行。

